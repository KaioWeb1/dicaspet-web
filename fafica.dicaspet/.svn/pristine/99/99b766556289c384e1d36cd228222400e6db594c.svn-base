package com.dicaspet.MB;

import java.util.ArrayList;
import java.util.List;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

import com.dicaspet.entidade.Mensagem;
import com.dicaspet.fachada.Fachada;

@ManagedBean(name="mensagemm")
@SessionScoped
public class MensagemMB {

	private Mensagem mensagem;
	private Fachada fachada;
	private List<Mensagem> mensagens;
	private List<Mensagem> ultimasMSG;

	public MensagemMB() {

		mensagem = new Mensagem();
		fachada = Fachada.getInstance();
	}

	public Mensagem getMensagem() {
		return mensagem;
	}

	public void setMensagem(Mensagem mensagem) {
		this.mensagem = mensagem;
	}

	public Fachada getFachada() {
		return fachada;
	}

	public void setFachada(Fachada fachada) {
		this.fachada = fachada;
	}

	public List<Mensagem> getMensagems() {
		if (mensagens == null) {
			try {
				mensagens = fachada.controladorMensagem().listar();
			} catch (Exception e) {
				mensagens = new ArrayList<Mensagem>();
				for (Mensagem m : mensagens) {
					System.out.println(m.getMsg_titulo());
				}
			}
		}

		return mensagens;
	}

	public void setMensagems(List<Mensagem> mensagems) {
		this.mensagens = mensagems;
	}

	public void cadastrar() {

		
		fachada.controladorMensagem().cadastrar(mensagem);
//		FacesMessage message;
//
//		message = FacesMessageUtil.criarMensagemInfo("Cadastro com Sucesso!",
//				"O mensagem " + mensagem.getUsu_nome()
//						+ " foi cadastrado com sucesso.");
limpar();
	}
	
	
	public List<Mensagem> getMensagens() {
		return mensagens;
	}

	public void setMensagens(List<Mensagem> mensagens) {
		this.mensagens = mensagens;
	}

	public List<Mensagem> getUltimasMSG() {
		
		if (ultimasMSG == null) {
			try {
				ultimasMSG = fachada.controladorMensagem().listarRecente();
			} catch (Exception e) {
				ultimasMSG = new ArrayList<Mensagem>();
			}
		}

		
		return ultimasMSG;
	}

	public void setUltimasMSG(List<Mensagem> ultimasMSG) {
		this.ultimasMSG = ultimasMSG;
	}

	private void limpar(){
		mensagem = new Mensagem();
	}

}
